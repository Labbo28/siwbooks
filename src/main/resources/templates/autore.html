<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
  <head th:replace="fragments/head :: head(${autore.nome + ' ' + autore.cognome})"></head>
  <body class="bg-light">
    <header class="header">…</header>
    <nav class="main-nav">…</nav>

    <main class="main-content py-5">
      <div class="container" style="max-width:800px;">
        <div class="content-card text-center mb-5">
          <h1 th:text="${autore.nome + ' ' + autore.cognome}"></h1>
          <div class="mb-3">
            <img th:if="${autore.immagine}" th:src="@{${autore.immagine.path}}"
                 class="img-fluid rounded" style="max-height:300px;">
          </div>
          <p><strong>Nato:</strong> <span th:text="${autore.dataNascita}"></span></p>
          <p th:if="${autore.dataMorte}"><strong>Morto:</strong> <span th:text="${autore.dataMorte}"></span></p>
          <p><strong>Nazionalità:</strong> <span th:text="${autore.nazionalita}"></span></p>
        </div>

        <section class="content-card mb-4">
          <h3><i class="fas fa-book"></i> Libri</h3>
          <ul class="list-group">
            <li th:each="l : ${autore.libri}" class="list-group-item d-flex justify-content-between">
              <a th:href="@{/libri/{id}(id=${l.id})}" th:text="${l.titolo}"
                 class="flex-grow-1 text-decoration-none"></a>
              <span sec:authorize="hasRole('ADMIN')">
                <a th:href="@{/autori/{aid}/{lid}/delete(aid=${autore.id},lid=${l.id})}"
                   class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></a>
              </span>
            </li>
            <li th:if="${#lists.isEmpty(autore.libri)}" class="list-group-item text-center text-muted">
              Nessun libro associato.
            </li>
          </ul>
        </section>

        <div sec:authorize="hasRole('ADMIN')" class="admin-panel content-card">
          <h4><i class="fas fa-cog"></i> Pannello Admin</h4>
          <div class="d-flex gap-2">
            <a th:href="@{/autori/{id}/edit(id=${autore.id})}" class="btn btn-warning">
              <i class="fas fa-edit"></i> Modifica
            </a>
            <a th:href="@{/autori/{id}/aggiungiLibri(id=${autore.id})}" class="btn btn-warning">
              <i class="fas fa-book-medical"></i> Aggiungi Libri
            </a>
          </div>
        </div>

        <div class="mt-4">
          <a th:href="@{/autori}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Torna ad Autori</a>
        </div>
      </div>
    </main>

    <footer class="footer">…</footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
